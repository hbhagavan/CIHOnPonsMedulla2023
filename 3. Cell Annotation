#title: 3. Cell Annotation
#author: Hemalatha Bhagavan [Center for Integrative Brain Research, Seattle Childrenâ€™s Research Institute, 1900 9th Ave, Seattle, WA, USA, hema.bhagavan@seattlechildrens.org] [![](https://orcid.org/sites/default/files/images/orcid_16x16.png)](https://orcid.org/0000-0002-7206-0593)

# load library
library(Seurat)
library(tidyverse)
library(RCurl)
library(cowplot)
library(RColorBrewer)
library(scater)
library(dplyr)
library(SingleR)
library(celldex)

# Load Data
seurat_integrated <- readRDS("results/integrated_seurat_singlets.rds")
DimPlot(seurat_integrated, reduction = "umap", label = TRUE, pt.size = .1)

# Cell annotation
mo_ref <- celldex::MouseRNAseqData()
cell_cluster <- SingleR(test = as.SingleCellExperiment(seurat_integrated),ref = mo_ref, labels = mo_ref$label.main)

table(cell_cluster$pruned.labels)

seurat_integrated$cell_cluster <- cell_cluster$pruned.labels

DimPlot(seurat_integrated, reduction = "umap", group.by = 'cell_cluster', label = T)


seurat_integrated <- subset(seurat_integrated, cell_cluster != 'NA')

length(seurat_integrated@active.ident)
# 14966

# Misidentified nuclei in the cell class clusters were excluded from the analysis
# Final cells used for all the downstream analysis

seu_obj <- readRDS("./results_inuse/clean_seu_obj_close.rds")

colors = c('#de71b4', '#44AA99','#a5ccc6','#f0aac4','#5b78eb','#332288','#b36f98','#54bbde','#f28fb8','#f28f8f',
           '#eb7b6e','#f03924','#5a857e','#DDCC77','#e89f74','#325c59','#999933','#b28ed4','#ad05ab','#1d33de',
           '#3d303d','#2f3635','#1b695d','#b0386a','#b86a8b','#6475f5','#44a7bd','#6bb1d6','#ff85b8')

DimPlot(seu_obj,cols = colors, pt.size = 0.1, label = F, label.size = 3)

length(seu_obj@active.ident)
# 10995

# save
